"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isTokenAfterPosition = exports.findFirstTokenAfterPosition = exports.findLastTokenBeforePosition = void 0;
/**
 * Finds last matching token before a certain position.
 *
 * @param pattern - Regular expression to which the token text should match. If omitted, then will match any token.
 * @param tokens - All tokens in the document.
 * @param position - Position before which the token should be.
 * @returns Last token before the given position.
 */
function findLastTokenBeforePosition(pattern, tokens, position) {
    let matchedToken;
    for (const token of tokens) {
        if (isTokenAfterPosition(token, position)) {
            return matchedToken;
        }
        if (!pattern || pattern.test(token.text)) {
            matchedToken = token;
        }
    }
    return undefined;
}
exports.findLastTokenBeforePosition = findLastTokenBeforePosition;
/**
 * Finds first matched token after a certain position.
 *
 * @param pattern - Regular expression to which the token text should match. If omitted, then will match any token.
 * @param tokens - All tokens in the document.
 * @param position - Position after which the token should be.
 * @returns First matched token after the given position.
 */
function findFirstTokenAfterPosition(pattern, tokens, position) {
    for (const token of tokens) {
        if (isTokenAfterPosition(token, position) && (!pattern || pattern.test(token.text))) {
            return token;
        }
    }
    return undefined;
}
exports.findFirstTokenAfterPosition = findFirstTokenAfterPosition;
/**
 * Checks if token is after a certain position in the file.
 *
 * @param token - All tokens in the document.
 * @param position - Position after which the token should be.
 * @returns - True if token is after the give position.
 */
function isTokenAfterPosition(token, position) {
    const line = token.line - 1; // line is 1 based in Token, but 0 based in Range
    if (line > position.line) {
        return true;
    }
    return line === position.line && token.column >= position.character;
}
exports.isTokenAfterPosition = isTokenAfterPosition;
//# sourceMappingURL=cds-compiler-tokens.js.map