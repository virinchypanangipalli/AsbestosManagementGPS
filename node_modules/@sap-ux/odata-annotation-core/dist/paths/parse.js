"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parsePath = exports.PATH_SEPARATOR = void 0;
const __1 = require("..");
exports.PATH_SEPARATOR = '/';
/**
 * Parses OData model paths.
 *
 * @param path OData model path.
 * @returns Parsed path.
 */
function parsePath(path) {
    const segments = path
        .split(exports.PATH_SEPARATOR)
        .map((segment) => {
        const termCastStartIndex = segment.indexOf('@');
        if (termCastStartIndex === 0) {
            const [term, qualifier] = segment.slice(1).split('#');
            const termCastIdentifier = (0, __1.parseIdentifier)(term);
            return {
                ...termCastIdentifier,
                type: 'term-cast',
                qualifier
            };
        }
        else if (termCastStartIndex > 0) {
            const [name, termCast] = segment.split('@');
            const termCastIdentifier = (0, __1.parseIdentifier)(name);
            const [term, qualifier] = termCast.split('#');
            return {
                ...termCastIdentifier,
                type: 'navigation-property-annotation',
                term: {
                    ...(0, __1.parseIdentifier)(term),
                    type: 'term-cast',
                    qualifier
                }
            };
        }
        const identifier = (0, __1.parseIdentifier)(segment);
        if (identifier.type === 'identifier' || identifier.type === 'action-function') {
            return identifier;
        }
        return undefined;
    })
        .filter((segment) => !!segment);
    return {
        segments
    };
}
exports.parsePath = parsePath;
//# sourceMappingURL=parse.js.map