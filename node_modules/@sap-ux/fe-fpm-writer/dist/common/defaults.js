"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDefaultFragmentContent = exports.getDefaultFragmentContentData = exports.setCommonDefaults = exports.FCL_ROUTER = void 0;
const path_1 = require("path");
exports.FCL_ROUTER = 'sap.f.routing.Router';
/**
 * Sets the common default values for all custom elements.
 *
 * @param config custom element configuration object
 * @param {string} manifestPath - path to the project's manifest.json
 * @param {Manifest} manifest - the application manifest
 * @returns enhanced configuration
 */
function setCommonDefaults(config, manifestPath, manifest) {
    // set target folder if not provided
    config.folder = config.folder || `ext/${config.name[0].toLocaleLowerCase() + config.name.substring(1)}`;
    // calculate namespace and path for generated artifacts
    config.ns = `${manifest['sap.app'].id}.${config.folder.replace(/[\/\\]/g, '.')}`;
    config.path = (0, path_1.join)((0, path_1.dirname)(manifestPath), config.folder);
    return config;
}
exports.setCommonDefaults = setCommonDefaults;
/**
 * Method to generate default content data for xml fragment.
 *
 * @param {string} text - text of button or label
 * @param {string} [eventHandler] - event handler path
 *      if value is passed then "Button" control with 'press' event would be generated
 *      if value is not passed then "Text" control would be generated
 * @param {boolean} isController - controls if `controller` should be added to handler path
 * @param {boolean} prefferInput - controls if `input` element should be added to default fragment content
 * @param {boolean} includeRequireInContent - controls if `core:require` attribute should be included to fragment content
 * @returns default content for fragment
 */
function getDefaultFragmentContentData(text, eventHandler, isController = false, prefferInput = false, includeRequireInContent = true) {
    let content;
    let requireAttribute;
    if (eventHandler) {
        const parts = eventHandler.split('.');
        const method = parts.pop();
        const handler = `${parts.join('/')}${isController ? '.controller' : ''}`;
        requireAttribute = `core:require="{ handler: '${handler}'}"`;
        const attributes = [];
        if (includeRequireInContent) {
            attributes.push(requireAttribute);
        }
        if (prefferInput) {
            attributes.push(`value="${text}"`);
            attributes.push(`change="handler.${method}"`);
            content = `<Input ${attributes.join(' ')} />`;
        }
        else {
            attributes.push(`text="${text}"`);
            attributes.push(`press="handler.${method}"`);
            content = `<Button ${attributes.join(' ')} />`;
        }
    }
    else if (prefferInput) {
        content = `<Input value="${text}" />`;
    }
    else {
        content = `<Text text="${text}" />`;
    }
    return {
        content,
        requireAttribute
    };
}
exports.getDefaultFragmentContentData = getDefaultFragmentContentData;
/**
 * Method to generate default content for xml fragment.
 *
 * @param {string} text - text of button or label
 * @param {string} [eventHandler] - event handler path
 *      if value is passed then "Button" control with 'press' event would be generated
 *      if value is not passed then "Text" control would be generated
 * @param {boolean} isController - controls if `controller` should be added to handler path
 * @param {boolean} prefferInput - controls if `input` element should be added to default fragment content
 * @returns default content for fragment
 */
function getDefaultFragmentContent(text, eventHandler, isController = false, prefferInput = false) {
    const contentData = getDefaultFragmentContentData(text, eventHandler, isController, prefferInput);
    return contentData.content;
}
exports.getDefaultFragmentContent = getDefaultFragmentContent;
//# sourceMappingURL=defaults.js.map